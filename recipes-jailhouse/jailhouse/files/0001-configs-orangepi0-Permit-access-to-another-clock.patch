From 2a33e404de0148d81e76e8926a5d2846ce0989c5 Mon Sep 17 00:00:00 2001
From: Jan Kiszka <jan.kiszka@siemens.com>
Date: Sat, 10 Nov 2018 15:10:12 +0100
Subject: [PATCH] configs: orangepi0: Permit access to another clock

This is required when using 4.19 as root kernel.

Signed-off-by: Jan Kiszka <jan.kiszka@siemens.com>
---
 configs/arm/orangepi0.c | 11 +++++++++--
 1 file changed, 9 insertions(+), 2 deletions(-)

diff --git a/configs/arm/orangepi0.c b/configs/arm/orangepi0.c
index 0284ae45..9eca773d 100644
--- a/configs/arm/orangepi0.c
+++ b/configs/arm/orangepi0.c
@@ -20,7 +20,7 @@
 struct {
 	struct jailhouse_system header;
 	__u64 cpus[1];
-	struct jailhouse_memory mem_regions[8];
+	struct jailhouse_memory mem_regions[9];
 	struct jailhouse_irqchip irqchips[1];
 	struct jailhouse_pci_device pci_devices[1];
 } __attribute__((packed)) config = {
@@ -76,6 +76,13 @@ struct {
 			.flags = JAILHOUSE_MEM_READ | JAILHOUSE_MEM_WRITE |
 				JAILHOUSE_MEM_IO,
 		},
+		/* clock (permissive) */ {
+			.phys_start = 0x01c20000,
+			.virt_start = 0x01c20000,
+			.size =            0x800,
+			.flags = JAILHOUSE_MEM_READ | JAILHOUSE_MEM_WRITE |
+				JAILHOUSE_MEM_IO | JAILHOUSE_MEM_IO_32,
+		},
 		/* pinctrl PA */ {
 			.phys_start = 0x01c20800,
 			.virt_start = 0x01c20800,
@@ -144,7 +151,7 @@ struct {
 				0xffffff00, 0xffffffff, 0x00000000,
 				0x00000000, 0x00000000, 0x00000000,
 			},
-			.shmem_region = 7,
+			.shmem_region = 8,
 			.shmem_protocol = JAILHOUSE_SHMEM_PROTO_VETH,
 		},
 	},
-- 
2.16.4

